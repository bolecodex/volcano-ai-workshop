# 智能搜索功能更新说明

## 📅 更新时间
2025年10月15日

## ✨ 重要更新

### 功能合并：智能搜索
将原有的"智能搜图"和"向量检索"功能合并为统一的"智能搜索"页面，提供更强大、更灵活的多模态搜索能力。

## 🎯 新功能特性

### 1. 多模态搜索支持

#### 文搜文/图/视频
- 📝 使用文本描述搜索文本内容
- 🖼️ 使用文本描述搜索图片
- 🎬 使用文本描述搜索视频
- 跨模态语义搜索

#### 图搜图/视频
- 🖼️ 上传图片查找相似图片
- 🎬 上传图片查找相关视频
- 支持图片 URL 和 TOS 地址

#### 视频搜索
- 🎬 上传视频查找相似视频
- 支持视频 URL 和 TOS 地址

#### 混合搜索
- 🎭 结合文本、图片、视频的综合搜索
- 多维度提高搜索精度

### 2. 灵活的配置选项

#### 数据集配置
- 🗄️ **Collection（数据集）**：指定 VikingDB 数据集名称
- 📇 **Index（索引）**：指定数据集索引名称
- 💾 配置自动保存到本地

#### 搜索参数
- 🔢 **TopK（返回数量）**：1-100，控制返回结果数量
- 📋 **输出字段**：自定义返回哪些字段（f_text, f_image, f_video 等）
- 🎯 **相似度排序**：结果按相似度自动排序

### 3. 搜索历史管理
- 📜 自动记录每次搜索
- 🏷️ 显示搜索模式、数据集、查询内容
- 🔢 保留最近 20 条记录
- 🗑️ 支持清空历史

## 📁 文件变更

### 新增文件
- ✅ `src/components/SmartSearch.js` - 智能搜索主组件
- ✅ `docs/SMART_SEARCH_GUIDE.md` - 详细使用指南
- ✅ `SMART_SEARCH_UPDATE.md` - 本更新说明

### 删除文件
- ❌ `src/components/ImageSearch.js` - 已合并到 SmartSearch
- ❌ `src/components/VectorSearch.js` - 已合并到 SmartSearch

### 修改文件
- 🔧 `src/components/Sidebar.js` - 更新菜单项为"智能搜索"
- 🔧 `src/App.js` - 更新路由使用 SmartSearch 组件

## 🚀 快速开始

### 第一步：配置密钥
```
1. 进入"设置"页面
2. 配置 AccessKeyId 和 SecretAccessKey
3. 密钥用于访问 VikingDB 服务
```

### 第二步：准备数据集
```
1. 在 VikingDB 控制台创建数据集
2. 创建索引并导入数据
3. 记录数据集和索引名称
```

### 第三步：配置搜索
```
1. 进入"智能搜索"页面
2. 填入数据集名称和索引名称（如: video_demo2）
3. 配置会自动保存
```

### 第四步：开始搜索
```
1. 选择搜索模式
2. 输入搜索内容（文本/图片/视频）
3. 设置搜索参数（TopK、输出字段）
4. 点击"开始搜索"
5. 查看搜索结果和相似度
```

## 🎨 界面预览

### 搜索页面
- 📊 数据集配置区域
- 🔘 搜索模式选择按钮
- 📝 搜索内容输入区
- ⚙️ 搜索参数设置
- 🎯 搜索结果展示（卡片式布局）

### 历史页面
- 📜 搜索历史列表
- 🏷️ 搜索模式标签
- 🗄️ 数据集和索引信息
- 🔢 结果数量统计
- 🕐 时间戳显示

### 说明页面
- 📖 功能说明
- 📋 使用步骤
- ⚙️ 配置说明
- ⚠️ 注意事项

## 🔧 技术实现

### API 集成
- **端点**: VikingDB Multi-Modal Search API
- **鉴权**: Signature V4（HMAC-SHA256）
- **请求方式**: POST with JSON body
- **响应格式**: JSON with items array

### 核心流程
```
用户输入（文本/图片/视频）
    ↓
构建搜索请求
    ↓
调用 VikingDB API（通过 Electron IPC）
    ↓
获取搜索结果
    ↓
计算相似度分数
    ↓
按分数排序展示
```

### 数据存储
- **配置数据**: localStorage（数据集、索引名称）
- **搜索历史**: localStorage（最多 20 条）
- **访问密钥**: storage.js 封装的 localStorage

## 📊 支持的数据格式

### 图片
- **格式**: JPEG, PNG, WebP, BMP
- **输入方式**: 文件上传 / URL / TOS 地址
- **最大大小**: 建议不超过 10MB

### 视频
- **格式**: MP4, AVI, MOV
- **输入方式**: 文件上传 / URL / TOS 地址
- **最大大小**: 建议不超过 50MB

### 文本
- **编码**: UTF-8
- **长度**: 无严格限制
- **格式**: 纯文本或关键词

## ⚙️ 搜索参数说明

### TopK（limit）
- **范围**: 1-100
- **默认值**: 10
- **说明**: 控制返回多少个结果
- **建议**: 
  - 精确搜索：1-5
  - 一般用途：10-20
  - 广泛搜索：50-100

### 输出字段（output_fields）
- **格式**: 逗号分隔的字段名
- **常用字段**:
  - `f_text`: 文本内容
  - `f_image`: 图片 URL
  - `f_video`: 视频 URL
  - `video_id`: 视频 ID
  - `landscape_video`: 横屏视频

## 🎯 使用场景

### 1. 内容搜索
- 通过关键词查找相关内容
- 跨模态搜索（文本查图片/视频）
- 语义理解查询

### 2. 相似内容推荐
- 以图搜图
- 以视频搜视频
- 找相似内容

### 3. 内容去重
- 识别重复图片
- 识别重复视频
- 内容版权保护

### 4. 内容审核
- 敏感内容识别
- 违规内容筛查
- 内容分类

## ⚠️ 注意事项

### 1. API 配置
- ✅ 需要配置 AccessKeyId 和 SecretAccessKey
- ✅ 密钥需要有 VikingDB 访问权限
- ✅ 建议使用子账号分配最小权限

### 2. 数据集准备
- ✅ 需要提前在 VikingDB 控制台创建数据集
- ✅ 数据集需要包含向量字段
- ✅ 确保数据已正确导入和索引

### 3. 搜索优化
- ✅ 使用清晰、准确的查询内容
- ✅ 合理设置 TopK 值
- ✅ 只返回需要的字段
- ✅ 避免频繁重复查询

### 4. 错误处理
- ⚠️ 404 错误：检查数据集和索引名称
- ⚠️ 权限错误：检查 AccessKey 权限
- ⚠️ 结果为空：调整查询内容或参数

## 📈 性能优化

### 1. 查询优化
- 使用精确的关键词
- 避免过长的文本查询
- 使用高质量的图片/视频

### 2. 参数优化
- 设置合理的 TopK 值
- 只返回必要的字段
- 使用缓存（搜索历史）

### 3. 网络优化
- 图片/视频建议使用 TOS 地址
- 避免上传过大的文件
- 合理控制请求频率

## 🔄 与旧版本的区别

| 特性 | 旧版（智能搜图） | 新版（智能搜索） |
|------|------------------|------------------|
| 搜索模式 | 仅支持图片搜索 | 文本/图片/视频/混合 |
| 数据集配置 | 固定或有限 | 完全自定义 |
| 输出字段 | 固定 | 完全可配置 |
| 搜索历史 | 基础记录 | 详细记录 |
| 界面布局 | 简单 | 标签页组织 |
| 说明文档 | 无 | 内置说明页 |

## 🎓 学习资源

- 📚 [详细使用指南](./docs/SMART_SEARCH_GUIDE.md)
- 🌐 [VikingDB 官方文档](https://www.volcengine.com/docs/84313/1211548)
- 🔧 [API 参考文档](https://www.volcengine.com/docs/84313/1254554)

## 💡 常见问题速查

### Q: 如何开始使用？
A: 先在设置中配置密钥，然后在 VikingDB 创建数据集，最后填入数据集名称即可搜索。

### Q: 返回 404 错误怎么办？
A: 检查数据集和索引名称是否正确，确认数据集已创建。

### Q: 搜索结果为空？
A: 检查数据集是否有数据，调整查询内容，确认输出字段配置正确。

### Q: 如何提高搜索精度？
A: 使用更精确的查询、高质量的图片、合理的 TopK 值。

### Q: 支持哪些图片格式？
A: 支持 JPEG, PNG, WebP, BMP 等常见格式。

### Q: 视频文件有大小限制吗？
A: 建议不超过 50MB，过大的文件会影响处理速度。

## 🎉 立即体验

1. 🚀 重启应用（应用已自动重新构建）
2. 📱 点击侧边栏的"智能搜索"
3. ⚙️ 配置数据集信息
4. 🔍 开始你的第一次智能搜索！

---

**版本**: v1.0.0  
**发布日期**: 2025年10月15日  
**构建状态**: ✅ 已编译成功  
**应用状态**: ✅ 已启动并运行

🎊 **享受全新的智能搜索体验！**

