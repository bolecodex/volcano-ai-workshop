# 即梦AI-视频生成3.0 Pro 使用指南

## 功能概述

即梦视频3.0 Pro 是即梦同源的文生视频与图生视频能力，在视频生成效果上实现飞跃。该版本具备多镜头叙事能力，能更精准遵循指令，动态表现流畅自然，支持生成1080P高清且具专业级质感的视频。

## 主要特点

- ✅ **文生视频**：输入文本提示词，生成视频
- ✅ **图生视频（首帧）**：输入首帧图片和对应的文本提示词，生成视频
- ✅ **高清输出**：支持生成1080P高清视频
- ✅ **多镜头叙事**：具备多镜头叙事能力
- ✅ **精准遵循指令**：更好地理解和执行用户指令
- ✅ **流畅自然**：动态表现流畅自然

## 前置条件

### 1. 配置访问密钥

即梦 3.0 Pro 使用 **签名V4认证**，需要配置 Access Key ID 和 Secret Access Key（不是普通的 API Key）。

1. 进入"设置"页面
2. 找到"访问密钥"部分
3. 填入您的 Access Key ID 和 Secret Access Key
4. 点击"保存设置"

### 2. 使用环境

- 必须在 Electron 桌面应用中使用
- 需要 Node.js 环境
- 需要网络连接

## 使用步骤

### 1. 进入功能页面

1. 启动应用
2. 点击侧边栏的"视频生成"
3. 选择"即梦 3.0 Pro"标签页

### 2. 选择生成类型

#### 文生视频

1. 选择"文生视频"类型
2. 输入文本提示词（必填）
   - 中英文均可
   - 建议在400字以内
   - 不超过800字
3. 设置参数：
   - **视频时长**：5秒(121帧) 或 10秒(241帧)
   - **宽高比**：16:9、4:3、1:1、3:4、9:16、21:9
   - **种子值**：-1为随机，或指定具体数值
4. 点击"创建即梦 3.0 Pro 视频任务"

#### 图生视频（首帧）

1. 选择"图生视频（首帧）"类型
2. 上传首帧图片或输入图片URL：
   - **支持格式**：JPEG、PNG
   - **文件大小**：最大 4.7MB
   - **分辨率**：最大 4096×4096，最短边不低于320px
   - **长宽比**：长边与短边比例在3以内
3. 输入文本提示词（可选，但推荐填写）
4. 设置参数（同文生视频）
5. 点击"创建即梦 3.0 Pro 视频任务"

### 3. 查看任务状态

- 任务提交后，会自动开始轮询查询状态
- 右侧"我的任务"面板会显示所有任务
- 任务状态：
  - `in_queue`：排队中
  - `generating`：生成中
  - `done`：完成
  - `not_found`：未找到
  - `expired`：已过期

### 4. 获取结果

- 当任务状态变为 `done` 时，会显示"播放"按钮
- 点击播放按钮可以在浏览器中查看和下载视频
- **注意**：视频链接有效期为12小时，请及时下载保存

## 参数说明

### 视频时长

- **121帧**：5秒视频（帧数 = 24 × 5 + 1）
- **241帧**：10秒视频（帧数 = 24 × 10 + 1）

### 宽高比与分辨率

| 宽高比 | 分辨率 |
|--------|--------|
| 21:9   | 2176 × 928 |
| 16:9   | 1920 × 1088 |
| 4:3    | 1664 × 1248 |
| 1:1    | 1440 × 1440 |
| 3:4    | 1248 × 1664 |
| 9:16   | 1088 × 1920 |

### 图片裁剪规则

当输入图片的宽高比与选定的宽高比不一致时：

1. 系统会自动选择最接近的目标比例
2. 进行居中裁剪
3. 裁剪规则：
   - 如果图片"太高"（竖向），以宽度为基准裁剪
   - 如果图片"太宽"（横向），以高度为基准裁剪
   - 确保裁剪内容居中

**建议**：上传图片的宽高比与目标比例尽可能接近，以获得更好的效果。

## API接口说明

### 提交任务

**接口地址**：
```
https://visual.volcengineapi.com?Action=CVSync2AsyncSubmitTask&Version=2022-08-31
```

**请求方法**：POST

**认证方式**：签名V4

**请求参数**：
```json
{
  "req_key": "jimeng_ti2v_v30_pro",
  "prompt": "文本提示词（可选）",
  "image_urls": ["图片URL"],  // 或使用 binary_data_base64
  "seed": -1,
  "frames": 121,
  "aspect_ratio": "16:9"
}
```

**返回参数**：
```json
{
  "code": 10000,
  "data": {
    "task_id": "任务ID"
  },
  "message": "Success"
}
```

### 查询任务

**接口地址**：
```
https://visual.volcengineapi.com?Action=CVSync2AsyncGetResult&Version=2022-08-31
```

**请求方法**：POST

**请求参数**：
```json
{
  "req_key": "jimeng_ti2v_v30_pro",
  "task_id": "任务ID"
}
```

**返回参数**：
```json
{
  "code": 10000,
  "data": {
    "status": "done",
    "video_url": "视频URL"
  },
  "message": "Success"
}
```

## 错误码说明

| HttpCode | 错误码 | 错误消息 | 描述 | 是否可重试 |
|----------|--------|----------|------|------------|
| 200 | 10000 | - | 请求成功 | 不需要 |
| 400 | 50411 | Pre Img Risk Not Pass | 输入图片前审核未通过 | 不需要 |
| 400 | 50511 | Post Img Risk Not Pass | 输出图片后审核未通过 | 可重试 |
| 400 | 50412 | Text Risk Not Pass | 输入文本前审核未通过 | 不需要 |
| 400 | 50512 | Post Text Risk Not Pass | 输出文本后审核未通过 | 不需要 |
| 400 | 50413 | Post Text Risk Not Pass | 输入文本含敏感词、版权词等审核不通过 | 不需要 |
| 429 | 50429 | Request Has Reached API Limit | QPS超限 | 可重试 |
| 429 | 50430 | Request Has Reached API Concurrent Limit | 并发超限 | 可重试 |
| 500 | 50500 | Internal Error | 内部错误 | 可重试 |
| 500 | 50501 | Internal RPC Error | 内部算法错误 | 可重试 |

## 提示词建议

### 文生视频

**好的提示词示例**：
```
一只可爱的橘猫在阳光明媚的花园里悠闲地散步，蝴蝶在花丛中飞舞，微风吹拂着绿叶，画面温馨而宁静
```

**要点**：
- 描述具体场景
- 包含动作元素
- 添加氛围描述
- 指定风格（如"电影感"、"动画风格"等）

### 图生视频（首帧）

**好的提示词示例**：
```
让画面中的人物自然地微笑和眨眼，头发随微风轻轻飘动
```

**要点**：
- 描述希望图片如何动起来
- 指定动作的幅度和速度
- 保持与图片内容相关

## 常见问题

### 1. 提示"需要配置 Access Key"

**解决方法**：
- 进入设置页面
- 配置 Access Key ID 和 Secret Access Key
- 注意：不是普通的 API Key

### 2. 任务一直处于排队状态

**原因**：
- 服务器负载较高
- 并发请求较多

**解决方法**：
- 等待5-10分钟
- 点击刷新按钮手动查询状态

### 3. 图片上传失败

**检查项**：
- 文件大小是否超过 4.7MB
- 文件格式是否为 JPEG 或 PNG
- 图片分辨率是否符合要求
- 图片宽高比是否在3以内

### 4. 提示词过长导致效果异常

**解决方法**：
- 精简提示词
- 控制在400字以内
- 突出重点描述

### 5. 视频链接失效

**原因**：
- 视频链接有效期为12小时

**解决方法**：
- 及时下载保存视频
- 如链接失效，需重新生成

## 技术实现

### 架构

```
前端 (React)
    ↓
Electron IPC
    ↓
Node.js (api-service.js)
    ↓
签名V4认证
    ↓
火山引擎 Visual API
```

### 关键文件

- `src/components/VideoGenerator.js` - 前端UI组件
- `api-service.js` - API服务层
- `desktop-app.js` - Electron主进程
- `public/preload.js` - 预加载脚本
- `signature-v4.js` - 签名V4实现

## 开发说明

如需扩展或修改功能，请参考以下文件：

1. **添加新参数**：修改 `src/components/VideoGenerator.js` 中的 `jimeng30ProForm` 状态
2. **修改API调用**：编辑 `api-service.js` 中的 `submitJimeng30ProVideoTask` 和 `queryJimeng30ProVideoTask` 方法
3. **添加IPC处理**：在 `desktop-app.js` 中添加新的 IPC handlers
4. **暴露新方法**：在 `public/preload.js` 中暴露新的 IPC 方法

## 更新日志

### v1.0.0 (2025-10-13)
- ✅ 实现即梦 3.0 Pro 视频生成功能
- ✅ 支持文生视频和图生视频（首帧）
- ✅ 自动轮询查询任务状态
- ✅ 任务列表管理
- ✅ 完整的错误处理

## 参考资料

- [即梦AI官方文档](https://www.volcengine.com/docs/6791/1213831)
- [签名V4认证说明](https://www.volcengine.com/docs/6791/65951)

## 技术支持

如有问题，请联系技术支持或查看官方文档。

