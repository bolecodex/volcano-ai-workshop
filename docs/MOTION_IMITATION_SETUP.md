# 动作模仿功能配置指南

## ✅ 功能状态
**动作模仿功能现已可用！** 已实现 Signature V4 签名认证。

## 🔑 配置步骤

### 第1步：创建访问密钥

1. 访问 [火山引擎 IAM 控制台](https://console.volcengine.com/iam/keymanage)
2. 点击"新建访问密钥"
3. 系统会生成一对密钥：
   - **AccessKeyId**: 类似 `AKLT***************`
   - **SecretAccessKey**: 类似 `****************************`
4. ⚠️ **重要**：SecretAccessKey 只会显示一次，请妥善保存！

### 第2步：在应用中配置

1. 打开应用，进入 **Settings（设置）** 页面
2. 找到 **"API 凭证配置"** 部分
3. 在 **"访问密钥 (用于动作模仿功能)"** 区域：
   - 输入您的 **AccessKeyId**
   - 输入您的 **SecretAccessKey**
4. 点击 **"保存 API 凭证"** 按钮

### 第3步：开始使用

1. 进入 **"动作模仿"** 页面
2. 上传一张静态图片（包含人物）
3. 上传一段驱动视频（包含要模仿的动作）
4. 点击 **"开始生成动作模仿视频"**
5. 等待处理完成（通常需要1-5分钟）
6. 预览和下载生成的视频

## 📋 技术实现

### 签名认证算法

应用使用 **AWS Signature Version 4** 算法进行认证：

1. **创建规范请求** - 标准化HTTP请求
2. **生成待签名字符串** - 包含时间戳和凭证范围
3. **计算签名** - 使用HMAC-SHA256
4. **添加Authorization头** - 将签名附加到请求中

### 关键文件

- `signature-v4.js` - 签名生成器
- `api-service.js` - API调用（包含签名逻辑）
- `storage.js` - 凭证存储
- `MotionImitation.js` - 前端组件
- `Settings.js` - 配置界面

## 🔐 安全说明

### 凭证存储

- 凭证保存在浏览器的 `localStorage` 中
- AccessKeyId 和 SecretAccessKey 仅在本地存储
- 不会上传到任何服务器（除了调用API时）

### 最佳实践

1. **不要分享凭证** - 您的密钥是私密的
2. **定期轮换** - 建议定期更换访问密钥
3. **最小权限原则** - 仅授予必要的权限
4. **安全传输** - 确保使用HTTPS连接

## 📊 API 限制

### 图片要求
- 格式：JPEG、PNG
- 大小：≤10MB
- 内容：包含清晰的人脸

### 驱动视频要求
- 格式：MP4、MOV、AVI
- 大小：≤100MB
- 内容：包含要模仿的动作和表情

### 其他限制
- 请求频率限制：根据您的配额
- 结果视频有效期：1小时
- 并发任务数：根据您的配额

## 🐛 故障排查

### 问题1：提示"需要提供 AccessKeyId 和 SecretAccessKey"

**解决方案：**
- 检查是否在设置页面正确配置了凭证
- 确保点击了"保存 API 凭证"按钮
- 刷新页面重试

### 问题2：提交任务失败

**可能原因：**
1. AccessKey 无效或已过期
2. 没有相应的权限
3. 图片或视频格式不支持

**解决方案：**
- 检查控制台日志获取详细错误信息
- 验证 AccessKey 是否正确
- 检查 IAM 权限设置

### 问题3：签名认证失败

**可能原因：**
- 时钟不同步
- 密钥输入错误

**解决方案：**
- 确保系统时间准确
- 重新输入 AccessKey 和 SecretKey
- 检查是否有多余的空格

## 📚 参考文档

- [火山引擎签名机制 V4](https://www.volcengine.com/docs/6348/69824)
- [单图视频驱动API](../docs/单图视频驱动.md)
- [IAM 访问密钥管理](https://www.volcengine.com/docs/6257/64932)

## 🎯 使用示例

### 示例1：基本使用

```
1. 上传一张正面人脸照片
2. 上传一段说话或做表情的视频
3. 等待生成
4. 下载结果视频
```

### 示例2：制作动态头像

```
1. 准备一张头像照片
2. 录制一段点头或挥手的视频
3. 生成动态头像
4. 用于社交媒体或个人网站
```

## 💡 提示与技巧

1. **图片质量** - 使用高质量、光线良好的正面照片效果最佳
2. **视频长度** - 建议驱动视频不超过10秒
3. **动作幅度** - 大幅度动作可能导致失真
4. **处理时间** - 越长的视频处理时间越久
5. **多次尝试** - 不同的驱动视频会产生不同效果

## 📞 获取帮助

如有问题，请：
1. 查看控制台日志
2. 参考文档
3. 联系技术支持

---

**版本：** v2.0.0
**更新日期：** 2025-10-13
**状态：** ✅ 功能正常

