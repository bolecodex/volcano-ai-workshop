# 智能搜图功能更新说明

## 📅 更新时间
2025年10月14日

## ✨ 新功能

### 🔍 智能搜图页面
集成火山引擎图像向量化 API，实现了完整的以图搜图系统。

#### 核心功能
1. **多模态搜索**
   - 🖼️ 以图搜图：上传图片查找相似图片
   - 📝 以文搜图：使用文字描述搜索图片
   - 🎭 混合搜索：图片+文字组合搜索
   - 🎬 视频搜索：支持视频输入（实验性功能）

2. **向量数据库管理**
   - 添加图片到本地向量库
   - 为图片添加名称和描述
   - 管理和删除向量库中的图片
   - 数据持久化存储（localStorage）

3. **智能相似度计算**
   - 使用余弦相似度算法
   - 直观的百分比显示
   - 自动排序搜索结果

4. **搜索历史**
   - 自动记录每次搜索
   - 保留最近20条记录
   - 显示详细搜索信息

## 📁 文件变更

### 新增文件
- ✅ `src/components/ImageSearch.js` - 智能搜图主组件
- ✅ `docs/IMAGE_SEARCH_GUIDE.md` - 详细使用指南
- ✅ `docs/IMAGE_SEARCH_IMPLEMENTATION.md` - 技术实现文档
- ✅ `docs/IMAGE_SEARCH_UPDATE.md` - 更新说明（本文件）

### 修改文件
- 🔧 `src/components/Sidebar.js` - 添加"智能搜图"菜单项
- 🔧 `src/App.js` - 添加路由和组件导入
- 🔧 `api-service.js` - 新增图像向量化 API 方法
- 🔧 `desktop-app.js` - 添加 IPC 处理器
- 🔧 `public/preload.js` - 暴露 API 方法给渲染进程

## 🎯 使用方法

### 第一步：配置 API Key
1. 进入"设置"页面
2. 输入火山引擎 ARK API Key
3. 保存配置

### 第二步：建立向量库
1. 进入"智能搜图"页面
2. 切换到"向量库"标签页
3. 点击"添加图片"
4. 上传图片并添加描述
5. 系统自动生成向量并保存

### 第三步：开始搜索
1. 切换到"搜索"标签页
2. 选择搜索模式（以图搜图/以文搜图/混合）
3. 上传图片或输入描述
4. 点击"开始搜索"
5. 查看搜索结果和相似度

## 🔧 技术亮点

### API 集成
- **端点**: `https://ark.cn-beijing.volces.com/api/v3/embeddings/multimodal`
- **模型**: `doubao-embedding-vision-250615` (推荐)
- **向量维度**: 1024 或 2048 维

### 相似度算法
```javascript
余弦相似度 = (A · B) / (||A|| × ||B||)
```
- 结果范围：0-1
- 值越大表示越相似

### 数据存储
- 向量数据存储在本地 localStorage
- 支持 Base64 图片预览
- 自动持久化保存

## 📊 支持格式

### 图片格式
- JPEG/JPG, PNG, WebP, BMP
- TIFF, ICO, DIB, ICNS, SGI, JPEG2000
- 最大 10MB，总像素不超过3600万

### 视频格式
- MP4, AVI, MOV
- 最大 50MB

### 文本输入
- UTF-8 编码
- 最大 100,000 字节
- 建议不超过 4096 tokens

## 🎨 界面预览

### 三个主要标签页

#### 1. 搜索标签页
- 🔍 搜索模式选择
- 📤 图片/视频上传
- ✏️ 文本输入
- 📊 结果展示和相似度

#### 2. 向量库标签页
- 📚 图片卡片展示
- ➕ 添加新图片
- 🗑️ 删除/清空功能
- 🏷️ 名称和描述

#### 3. 历史标签页
- 📜 搜索记录列表
- 🕐 时间戳显示
- 🏷️ 搜索模式标签
- 🔢 结果数量统计

## ⚡ 性能特性

- ✅ 客户端向量计算
- ✅ 本地数据存储
- ✅ 实时相似度分析
- ✅ 响应式界面设计
- ✅ 错误处理和验证

## 🔐 安全特性

- 🔒 API Key 本地存储
- 🔒 不上传用户数据
- 🔒 输入验证和过滤
- 🔒 文件类型检查

## 📝 配置选项

### 模型选择
- `doubao-embedding-vision-250615` (新版，推荐)
- `doubao-embedding-vision-250328` (旧版)

### 向量维度
- `1024` - 较快，存储小
- `2048` - 更精确（推荐）

### 编码格式
- `float` - 浮点数（推荐）
- `base64` - Base64编码

## 💡 使用提示

1. **提高搜索准确度**
   - 使用高质量图片
   - 添加详细文字描述
   - 选择2048维向量
   - 向量库中添加更多相关图片

2. **性能优化**
   - 压缩大图片后再上传
   - 向量库建议不超过100张图片
   - 定期清理不需要的向量数据

3. **数据管理**
   - 定期导出重要图片
   - 记录图片来源URL
   - 备份向量数据库

## ❗ 注意事项

1. **存储限制**
   - localStorage 通常限制 5-10MB
   - Base64 编码会增加数据大小
   - 建议定期清理不需要的数据

2. **API 使用**
   - 需要有效的火山引擎 API Key
   - 每次搜索会消耗 tokens
   - 注意查看 token 使用情况

3. **浏览器兼容**
   - 推荐使用 Chrome/Edge
   - 需要支持 localStorage
   - 需要支持 FileReader API

## 🚀 快速开始

```bash
# 1. 启动应用
npm start

# 2. 进入智能搜图页面
点击侧边栏"智能搜图"

# 3. 配置 API Key
进入设置页面配置

# 4. 添加图片到向量库
在向量库标签页添加图片

# 5. 开始搜索
在搜索标签页上传图片或输入文字
```

## 📚 相关文档

- [详细使用指南](./IMAGE_SEARCH_GUIDE.md)
- [技术实现文档](./IMAGE_SEARCH_IMPLEMENTATION.md)
- [图像向量化 API 文档](./图像向量化%20API.md)

## 🐛 已知问题

目前暂无已知严重问题。如发现问题请及时反馈。

## 🔮 未来计划

- [ ] 支持批量图片上传
- [ ] 添加图片分类和标签
- [ ] 云端向量库同步
- [ ] 高级搜索过滤器
- [ ] 搜索结果导出
- [ ] 性能优化和索引

## 📞 支持

如有问题或建议，请：
- 查看详细使用指南
- 检查 API Key 配置
- 查看浏览器控制台日志
- 联系技术支持

---

**版本**: v1.0.0  
**更新**: 2025年10月14日  
**状态**: ✅ 已完成并可用  

🎉 **开始使用智能搜图，体验 AI 驱动的图像检索！**


